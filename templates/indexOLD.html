{% extends "base.html" %}

{% block content %}
    <h1>Previanza - Dashboard</h1>
    {% if current_user.is_authenticated %}
        <p>Hola, {{ current_user.username }}!</p>
        <h2>Enlaces Rápidos</h2>
        <div class="view-toggle">
            <button id="cardViewBtn" class="btn btn-primary active">Vista de Tarjetas</button>
            <button id="listViewBtn" class="btn btn-secondary">Vista de Lista</button>
        </div>
        <div id="cardView" class="dashboard-grid">
            {% if current_user.role in [UserRole.ADMIN, UserRole.DIGITADOR] %}
                <a href="{{ url_for('clients.list_clients') }}" class="card">
                    <i class="fas fa-users"></i>
                    <h3>Gestionar Clientes</h3>
                    <p>Ver y administrar la información de los clientes</p>
                </a>
                <a href="{{ url_for('policies.list_policies') }}" class="card">
                    <i class="fas fa-file-contract"></i>
                    <h3>Gestionar Pólizas</h3>
                    <p>Administrar pólizas de seguros</p>
                </a>
                <a href="{{ url_for('products.list_products') }}" class="card">
                    <i class="fas fa-box"></i>
                    <h3>Ver Productos</h3>
                    <p>Explorar y gestionar productos de seguros</p>
                </a>
            {% endif %}
            {% if current_user.role == UserRole.ADMIN %}
                <a href="{{ url_for('agents.list_agents') }}" class="card">
                    <i class="fas fa-user-tie"></i>
                    <h3>Ver Agentes</h3>
                    <p>Administrar agentes de ventas</p>
                </a>
                <a href="{{ url_for('auth.register') }}" class="card">
                    <i class="fas fa-user-plus"></i>
                    <h3>Registrar Usuario</h3>
                    <p>Crear nuevas cuentas de usuario</p>
                </a>
                <a href="{{ url_for('config.config_index') }}" class="card">
                    <i class="fas fa-cogs"></i>
                    <h3>Configuración</h3>
                    <p>Configurar opciones del sistema</p>
                </a>
            {% endif %}
            {% if current_user.role == UserRole.AGENTE %}
                <a href="{{ url_for('policies.list_policies') }}" class="card">
                    <i class="fas fa-clipboard-list"></i>
                    <h3>Mis Pólizas</h3>
                    <p>Ver y gestionar mis pólizas asignadas</p>
                </a>
            {% endif %}
            <a href="{{ url_for('reports.sales_report') }}" class="card">
                <i class="fas fa-chart-line"></i>
                <h3>Ver Informes</h3>
                <p>Acceder a informes y análisis</p>
            </a>
        </div>
        <div id="listView" class="dashboard-list" style="display: none;">
            <ul>
                {% if current_user.role in [UserRole.ADMIN, UserRole.DIGITADOR] %}
                    <li><a href="{{ url_for('clients.list_clients') }}"><i class="fas fa-users"></i> Gestionar Clientes</a></li>
                    <li><a href="{{ url_for('policies.list_policies') }}"><i class="fas fa-file-contract"></i> Gestionar Pólizas</a></li>
                    <li><a href="{{ url_for('products.list_products') }}"><i class="fas fa-box"></i> Ver Productos</a></li>
                {% endif %}
                {% if current_user.role == UserRole.ADMIN %}
                    <li><a href="{{ url_for('agents.list_agents') }}"><i class="fas fa-user-tie"></i> Ver Agentes</a></li>
                    <li><a href="{{ url_for('auth.register') }}"><i class="fas fa-user-plus"></i> Registrar Usuario</a></li>
                    <li><a href="{{ url_for('config.config_index') }}"><i class="fas fa-cogs"></i> Configuración</a></li>
                {% endif %}
                {% if current_user.role == UserRole.AGENTE %}
                    <li><a href="{{ url_for('policies.list_policies') }}"><i class="fas fa-clipboard-list"></i> Mis Pólizas</a></li>
                {% endif %}
                <li><a href="{{ url_for('reports.sales_report') }}"><i class="fas fa-chart-line"></i> Ver Informes</a></li>
            </ul>
        </div>
    {% else %}
        <div class="card">
            <p>Por favor <a href="{{ url_for('auth.login') }}">inicie sesión</a> para acceder al sistema.</p>
        </div>
    {% endif %}
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const cardViewBtn = document.getElementById('cardViewBtn');
        const listViewBtn = document.getElementById('listViewBtn');
        const cardView = document.getElementById('cardView');
        const listView = document.getElementById('listView');

        cardViewBtn.addEventListener('click', function() {
            cardView.style.display = 'grid';
            listView.style.display = 'none';
            cardViewBtn.classList.add('active');
            listViewBtn.classList.remove('active');
        });

        listViewBtn.addEventListener('click', function() {
            cardView.style.display = 'none';
            listView.style.display = 'block';
            listViewBtn.classList.add('active');
            cardViewBtn.classList.remove('active');
        });
    });
</script>
{% endblock %}
